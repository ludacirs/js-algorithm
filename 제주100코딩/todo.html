<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div class="todo">
    <h1>할 일</h1>
    <ul class="list">
    </ul>
    <label>
        <input type="text" class="desc"/>
    </label>
    <button onclick="onAdd()"> 추가</button>
    <button onclick="onSaveToServer()"> 서버에 추가</button>

</div>


<script>
    let currentId = 1;
    const todoList = [];

    function onAdd(){
        const descElem = document.querySelector('.desc');
        const todo = { id : currentId++, desc : descElem.value};
        todoList.push(todo);
        const listElem = document.querySelector('.list');
        const todoElem = createTodo(todo);
        listElem.appendChild(todoElem);
    }


    function onDelete(e) {
        const id = Number(e.target.dataset.id);
        const index = todoList.findIndex(v=> v.id===id);

        if(index >=0){
            console.log(`asd`);
            todoList.splice(index, 1);
            const listElem = document.querySelector('.list');
            const todoElem = e.target.parentNode;
            listElem.removeChild(todoElem);
        }
    }

    function createTodo(todo) {
        const todoElem = document.createElement('li');
        const spanElem = document.createElement('span');
        const buttonElem = document.createElement('button');
        spanElem.innerHTML = todo.desc;
        buttonElem.dataset.id = todo.id;
        buttonElem.onclick = onDelete;
        buttonElem.innerHTML = '삭제';
        todoElem.appendChild(spanElem);
        todoElem.appendChild(buttonElem);

        return todoElem;
    }

    function onSaveToServer() {
    }

</script>

</body>
</html>